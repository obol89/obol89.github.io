{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Obol's documentation","text":"<p>Feel free to use these notes for your own purposes.</p>"},{"location":"#donate-me-if-you-like-my-work","title":"Donate me if you like my work","text":"<p>BTC - <code>1Ljk4nkfsv2DWkM3DAWwEkSkahZB8u4Qvt</code> ETH - <code>0xF49e94E81A8d51Ee5dd9D582A33bf7c5d4ee4f1E</code></p>"},{"location":"#contact","title":"Contact","text":"<p>In case of any questions, email me <code>docs@obolit.net</code></p>"},{"location":"tags/","title":"Tags","text":"<p>Following is a list of relevant tags:</p>"},{"location":"tags/#tag:apt","title":"APT","text":"<ul> <li>            Create APT repository on CentOS          </li> </ul>"},{"location":"tags/#tag:ansible","title":"Ansible","text":"<ul> <li>            Gather or update ansible facts          </li> </ul>"},{"location":"tags/#tag:centos","title":"CentOS","text":"<ul> <li>            Use two network gateways with CentOS          </li> </ul>"},{"location":"tags/#tag:cisco","title":"Cisco","text":"<ul> <li>            Restart port on Cisco device          </li> </ul>"},{"location":"tags/#tag:database","title":"Database","text":"<ul> <li>            Authentication plugin caching_sha2_password cannot be loaded          </li> <li>            Change MySQL Password Policy Level          </li> <li>            Check size of the MySQL table          </li> <li>            Copy MySQL database          </li> <li>            Host is not allowed to connect to this MySQL server          </li> <li>            Install Percona MySQL Server 8 on CentOS 8          </li> </ul>"},{"location":"tags/#tag:debian","title":"Debian","text":"<ul> <li>            Create preseed with LVM and partman          </li> <li>            Refresh snap packages / update snap          </li> <li>            Update firmware on Linux          </li> </ul>"},{"location":"tags/#tag:diskpart","title":"Diskpart","text":"<ul> <li>            Repair corrupted USB drive in Windows          </li> </ul>"},{"location":"tags/#tag:elastic","title":"Elastic","text":"<ul> <li>            Bringing custom logs to Elasticsearch          </li> </ul>"},{"location":"tags/#tag:fdisk","title":"Fdisk","text":"<ul> <li>            Extend LVM in Linux          </li> <li>            Extend partition without LVM in Linux          </li> <li>            Repair corrupted USB drive in Linux          </li> </ul>"},{"location":"tags/#tag:filesystem","title":"Filesystem","text":"<ul> <li>            Copy files with SCP          </li> <li>            Create empty file to take disk space on Linux          </li> <li>            Delete files older than X days          </li> <li>            Extend LVM in Linux          </li> <li>            Extend partition without LVM in Linux          </li> <li>            Increase Swap space          </li> <li>            Move /var to new partition in CentOS          </li> <li>            Repair corrupted USB drive in Linux          </li> <li>            Repair corrupted USB drive in Windows          </li> <li>            Required SSH files permissions          </li> </ul>"},{"location":"tags/#tag:git","title":"Git","text":"<ul> <li>            Delete branch in git          </li> </ul>"},{"location":"tags/#tag:iptables","title":"Iptables","text":"<ul> <li>            List and add Iptables rules          </li> </ul>"},{"location":"tags/#tag:lvm","title":"LVM","text":"<ul> <li>            Create preseed with LVM and partman          </li> <li>            Extend LVM in Linux          </li> </ul>"},{"location":"tags/#tag:linux","title":"Linux","text":"<ul> <li>            Authentication plugin caching_sha2_password cannot be loaded          </li> <li>            Change MySQL Password Policy Level          </li> <li>            Check size of the MySQL table          </li> <li>            Configure static IP address on CentOS 8          </li> <li>            Copy MySQL database          </li> <li>            Copy files with SCP          </li> <li>            Create APT repository on CentOS          </li> <li>            Create empty file to take disk space on Linux          </li> <li>            Delete branch in git          </li> <li>            Delete files older than X days          </li> <li>            Extend LVM in Linux          </li> <li>            Extend partition without LVM in Linux          </li> <li>            Gather or update ansible facts          </li> <li>            Host is not allowed to connect to this MySQL server          </li> <li>            Increase Swap space          </li> <li>            Install Percona MySQL Server 8 on CentOS 8          </li> <li>            List and add Iptables rules          </li> <li>            Move /var to new partition in CentOS          </li> <li>            Refresh snap packages / update snap          </li> <li>            Repair corrupted USB drive in Linux          </li> <li>            Required SSH files permissions          </li> <li>            Screen commands          </li> <li>            Speed test between two hosts          </li> <li>            Update firmware on Linux          </li> <li>            Use two network gateways with CentOS          </li> </ul>"},{"location":"tags/#tag:mysql","title":"MySQL","text":"<ul> <li>            Authentication plugin caching_sha2_password cannot be loaded          </li> <li>            Change MySQL Password Policy Level          </li> <li>            Check size of the MySQL table          </li> <li>            Copy MySQL database          </li> <li>            Host is not allowed to connect to this MySQL server          </li> <li>            Install Percona MySQL Server 8 on CentOS 8          </li> </ul>"},{"location":"tags/#tag:network","title":"Network","text":"<ul> <li>            Configure static IP address on CentOS 8          </li> <li>            List and add Iptables rules          </li> <li>            Restart port on Cisco device          </li> <li>            Speed test between two hosts          </li> <li>            Use two network gateways with CentOS          </li> </ul>"},{"location":"tags/#tag:partman","title":"Partman","text":"<ul> <li>            Create preseed with LVM and partman          </li> </ul>"},{"location":"tags/#tag:preseed","title":"Preseed","text":"<ul> <li>            Create preseed with LVM and partman          </li> </ul>"},{"location":"tags/#tag:repository","title":"Repository","text":"<ul> <li>            Create APT repository on CentOS          </li> <li>            Refresh snap packages / update snap          </li> </ul>"},{"location":"tags/#tag:scp","title":"SCP","text":"<ul> <li>            Copy files with SCP          </li> </ul>"},{"location":"tags/#tag:ssh","title":"SSH","text":"<ul> <li>            Required SSH files permissions          </li> </ul>"},{"location":"tags/#tag:snap","title":"Snap","text":"<ul> <li>            Refresh snap packages / update snap          </li> </ul>"},{"location":"tags/#tag:tools","title":"Tools","text":"<ul> <li>            Screen commands          </li> </ul>"},{"location":"tags/#tag:ubuntu","title":"Ubuntu","text":"<ul> <li>            Refresh snap packages / update snap          </li> <li>            Update firmware on Linux          </li> </ul>"},{"location":"tags/#tag:windows","title":"Windows","text":"<ul> <li>            Repair corrupted USB drive in Windows          </li> </ul>"},{"location":"posts/apt_repo_centos/","title":"Create an APT repository on CentOS","text":"<p>Systems like Ubuntu, Debian or Mint are using apt packages. There is also the possibility to share apt packages from CentOS. We are going to create an apt repository stored locally with gpg signed packages to avoid questions like \"Do you trust the source?\".</p>","tags":["APT","Repository","Linux"]},{"location":"posts/apt_repo_centos/#preparing-gpg-keys","title":"Preparing gpg keys","text":"<p>Keep in mind generating new keys can require some time for entropy generation. as root, no sudo! <code>gpg --gen-key</code></p> <p>For the first time you run <code>gpg --gen-key</code>, break it after it has generated some directories and files. By default they are located in <code>~/.gnupg/</code> Add the SHA256 requirement to the <code>gpg.conf</code></p> <pre><code>cat &lt;&lt;'EOF' &gt;&gt; ~/.gnupg/gpg.conf\ncert-digest-algo SHA256\ndigest-algo SHA256\nEOF\n</code></pre> <p>Run gpg again and this time go through all the prompts to generate the key. <code>gpg --gen-key</code> This step might take a lot of time. If you need to speed this up you can open new terminal and run something like that:  </p> <pre><code>while true; do dd if=/dev/sda of=/dev/zero; find / | xargs file &gt;/dev/null 2&gt;&amp;1; done\n</code></pre> <p>Stop it with ctrl+c when gpg keys will finish to generate. After that you will need to export generated keys</p> <p><code>gpg --list-keys</code></p> <p><code>gpg --output your-PUBLIC-key-name-here.gpg --armor --export 123456AB</code></p> <p><code>gpg --output your-PRIVATE-key-name-here.gpg --armor --export-secret-key 123456AB</code></p> <p>Preferably is to put the public key available in the repository directory.</p>","tags":["APT","Repository","Linux"]},{"location":"posts/apt_repo_centos/#installing-required-packages","title":"Installing required packages","text":"<p>Install epel-release that let you install dpkg-dev and tar packageds you need.</p> <p><code>yum -y install epel-release dpkg-dev tar</code></p>","tags":["APT","Repository","Linux"]},{"location":"posts/apt_repo_centos/#script-to-build-the-repository","title":"Script to build the repository","text":"<pre><code>updatescript=/mnt/mirror/ubuntu/example-ubuntu/update-repo.sh\ncat &lt;&lt;'EOFSH' &gt;${updatescript}\n#!/bin/sh\n\n# working directory\nrepodir=/mnt/mirror/ubuntu/example-ubuntu/\ncd ${repodir}\n\n# create the package index\ndpkg-scanpackages -m . &gt; Packages\ncat Packages | gzip -9c &gt; Packages.gz\n\n# create the Release file\nPKGS=$(wc -c Packages)\nPKGS_GZ=$(wc -c Packages.gz)\ncat &lt;&lt;EOF &gt; Release\nArchitectures: all\nDate: \\$(date -R)\nMD5Sum:\n $(md5sum Packages  | cut -d\" \" -f1) $PKGS\n $(md5sum Packages.gz  | cut -d\" \" -f1) $PKGS_GZ\nSHA1:\n $(sha1sum Packages  | cut -d\" \" -f1) $PKGS\n $(sha1sum Packages.gz  | cut -d\" \" -f1) $PKGS_GZ\nSHA256:\n $(sha256sum Packages | cut -d\" \" -f1) $PKGS\n $(sha256sum Packages.gz | cut -d\" \" -f1) $PKGS_GZ\nEOF\ngpg -abs -o Release.gpg Release\nEOFSH\nchmod 755 ${updatescript}\n</code></pre>","tags":["APT","Repository","Linux"]},{"location":"posts/apt_repo_centos/#adding-packages-to-the-repository","title":"Adding packages to the repository","text":"<p>Move any package to the repository directory and run the update script.</p> <p><code>./update-repo.sh</code></p> <p>Using repository as a client</p> <p>You need to import public key and add entry in your sources.list file.</p> <pre><code>sudo wget http://mirror.example.com/ubuntu/your-PUBLIC-key-name-here.gpg\n</code></pre> <pre><code>sudo apt-key add /root/your-PUBLIC-key-name-here.gpg\n</code></pre> <pre><code>sudo wget http://mirror.example.com/ubuntu/example-ubuntu/example-ubuntu.list -O /etc/apt/sources.list.d/example-ubuntu.list\n</code></pre> <p>Update available package list</p> <p><code>apt-get update</code></p>","tags":["APT","Repository","Linux"]},{"location":"posts/cisco_port_restart/","title":"How to bring the port up from the flapping state on Cisco?","text":"<p>If you have issues with port on your Cisco switch you need to use these commands: With this command you will be able to locate flapping port:</p> <pre><code>sh int status\n</code></pre> <p>Go to the configuration state:</p> <pre><code>conf t\n</code></pre> <p>Let's use <code>eth1/6</code> as an example.</p> <pre><code>int eth1/6\n</code></pre> <p>Switch off and switch on the port:</p> <pre><code>shut\n</code></pre> <pre><code>no shut\n</code></pre> <p>We need to <code>exit</code> twice:</p> <pre><code>exit\n</code></pre> <pre><code>exit\n</code></pre> <p>And save our config:</p> <pre><code>wr\n</code></pre>","tags":["Cisco","Network"]},{"location":"posts/copy_mysql_database/","title":"How To Copy a MySQL Database","text":"<p>This manual shows you how to copy a MySQL database on the same server and from a server to another. With this manual, you also be able to copy only one table from one MySQL database to another.</p> <p>For the demonstration, we will copy the <code>db_test</code> database to <code>db_test_2</code> database. We assume that <code>db_test</code> exists.</p> <p>Create the <code>db_test_2</code> database:</p> <pre><code>mysql -u root -p\n</code></pre> <pre><code>&gt; CREATE DATABASE db_test_2;\n</code></pre> <p>Dump database objects and data into SQL file using the mysqldump tool.  </p>","tags":["MySQL","Database","Linux"]},{"location":"posts/copy_mysql_database/#a-if-you-want-to-move-the-whole-database","title":"a) If you want to move the whole database","text":"<pre><code>mysqldump -u root -p db_test &gt; /tmp/db_test.sql\n</code></pre>","tags":["MySQL","Database","Linux"]},{"location":"posts/copy_mysql_database/#b-if-you-want-to-move-only-certain-tables","title":"b) If you want to move only certain tables","text":"<pre><code>mysqldump -u root -p db_test tablename1 tablename2 &gt; /tmp/db_test_tables.sql\n</code></pre> <p>Import the <code>db_test_tables.sql</code> or <code>db_test.sql</code> to your new database.</p> <pre><code>mysql -u root -p db_test_2 &lt; db_test_tables.sql\n</code></pre>","tags":["MySQL","Database","Linux"]},{"location":"posts/custom_logs_elastic/","title":"Work in progress","text":"","tags":["Elastic"]},{"location":"posts/delete_git_branch/","title":"Delete git branch","text":"<p>The basic command syntax for deleting branch is: <code>git branch (-d | -D) [-r] &lt;branchname&gt;...</code></p> <p>Note that each local branch has a corresponding upstream branch from the remote: origin</p> <p>The simplest form of the command deletes a local branch: <code>git branch -d dev</code></p> <p>If you delete a branch that only exists locally, with unmerged changes, you\u2019ll lose those changes. Therefore, git will refuse to delete a branch in such a situation, by default:</p> <p>error: The branch <code>dev</code> is not fully merged. If you are sure you want to delete it, run <code>git branch -D dev</code>.</p> <p>So, you need to use: <code>git branch -D dev</code></p> <p>To remove remote branch you need to use git push command along with the <code>-d</code> flag.  </p> <pre><code>$ git push -d origin dev\n\nTo github.com:obol89/test.git\n- [deleted] dev\n</code></pre>","tags":["Git","Linux"]},{"location":"posts/dummy_file/","title":"Creating empty file to take disk space on Linux","text":"<p>The purpose of creating empty file might be to test the disk alerting, or just check if there are no issues with filesystem.</p> <p>The command is simple:</p> <pre><code>dd if=/dev/zero of=/var/filename2 bs=$((1024*1024)) count=$((16*1024))\n</code></pre> <p><code>count</code> is the place where you should put multiple of 1024MB.</p> <p>Another command:</p> <pre><code>fallocate -l 85G filename3\n</code></pre>","tags":["Filesystem","Linux"]},{"location":"posts/extend_lvm_linux/","title":"How to extend LVM in Linux","text":"<p>Firstly, you can check your Physical Volumes, Volume Groups and Logical Volumes with commands:</p>","tags":["Filesystem","Fdisk","LVM","Linux"]},{"location":"posts/extend_lvm_linux/#physical-volumes","title":"Physical Volumes","text":"<pre><code>pvs\n</code></pre> <pre><code>PV         VG             Fmt  Attr PSize   PFree\n/dev/sda2  centos_centos7 lvm2 a--  &lt;19.00g    0\n</code></pre>","tags":["Filesystem","Fdisk","LVM","Linux"]},{"location":"posts/extend_lvm_linux/#volume-groups","title":"Volume Groups","text":"<pre><code>vgs\n</code></pre> <pre><code>VG             #PV #LV #SN Attr   VSize   VFree\ncentos_centos7   1   2   0 wz--n- &lt;19.00g    0\n</code></pre>","tags":["Filesystem","Fdisk","LVM","Linux"]},{"location":"posts/extend_lvm_linux/#logical-volumes","title":"Logical Volumes","text":"<pre><code>lvs\n</code></pre> <pre><code>LV   VG             Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert\nroot centos_centos7 -wi-ao---- &lt;17.00g\nswap centos_centos7 -wi-ao----   2.00g\n</code></pre> <p>For adding a new Physical Volume we have to find the name of a new volume. We can use the following command to locate it:</p> <pre><code>fdisk -l\n</code></pre> <pre><code>Disk /dev/sda: 21.5 GB, 21474836480 bytes, 41943040 sectors\nUnits = sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisk label type: dos\nDisk identifier: 0x000b3a0f\n\n   Device Boot      Start         End      Blocks   Id  System\n/dev/sda1   *        2048     2099199     1048576   83  Linux\n/dev/sda2         2099200    41943039    19921920   8e  Linux LVM\n\nDisk /dev/sdb: 10.7 GB, 10737418240 bytes, 20971520 sectors\nUnits = sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\n\n\nDisk /dev/mapper/centos_centos7-root: 18.2 GB, 18249416704 bytes, 35643392 sectors\nUnits = sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\n\n\nDisk /dev/mapper/centos_centos7-swap: 2147 MB, 2147483648 bytes, 4194304 sectors\nUnits = sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\n</code></pre> <p>Now, it\u2019s time to configure our new disk.</p> <pre><code>fdisk /dev/sdb\n</code></pre> <p>To create new partition Press\u00a0<code>n</code> Choose primary partition user <code>p</code> Change the type using <code>t</code> Type <code>8e</code> to change the partition type to Linux LVM Use <code>p</code> to print the create partition Press <code>w</code> to write the changes  </p> <pre><code>Welcome to fdisk (util-linux 2.23.2).\n\nChanges will remain in memory only, until you decide to write them.\nBe careful before using the write command.\n\nDevice does not contain a recognized partition table\nBuilding a new DOS disklabel with disk identifier 0x38e14a7a.\n\nCommand (m for help): n\nPartition type:\n   p   primary (0 primary, 0 extended, 4 free)\n   e   extended\nSelect (default p): p\nPartition number (1-4, default 1):\nFirst sector (2048-20971519, default 2048):\nUsing default value 2048\nLast sector, +sectors or +size{K,M,G} (2048-20971519, default 20971519):\nUsing default value 20971519\nPartition 1 of type Linux and of size 10 GiB is set\n\nCommand (m for help): t\nSelected partition 1\nHex code (type L to list all codes): 8e\nChanged type of partition 'Linux' to 'Linux LVM'\n\nCommand (m for help): w\nThe partition table has been altered!\n\nCalling ioctl() to re-read partition table.\nSyncing disks.\n</code></pre> <p>Next, create new Physical Volume</p> <pre><code>pvcreate /dev/sdb1\n</code></pre> <pre><code>Physical volume /dev/sdb1 successfully created.\n</code></pre> <p>Verify the physical volume using the below command:</p> <pre><code>pvs\n</code></pre> <pre><code>PV         VG             Fmt  Attr PSize   PFree\n/dev/sda2  centos_centos7 lvm2 a--  &lt;19.00g      0\n/dev/sdb1                 lvm2 ---  &lt;10.00g &lt;10.00g\n</code></pre> <p>Add this <code>pv</code> to <code>centos</code> volume group to extend the size of a volume group to get more space:</p> <pre><code>vgextend centos_centos7 /dev/sdb1\n</code></pre> <pre><code>Volume group \"centos_centos7\" successfully extended\n</code></pre> <pre><code>vgs\n</code></pre> <pre><code>VG             #PV #LV #SN Attr   VSize  VFree\ncentos_centos7   2   2   0 wz--n- 28.99g &lt;10.00g\n</code></pre> <p>It\u2019s time to extend logical volume. If you would like to extend your logical volume with all free available space type the following command:</p> <pre><code>lvextend -l +100%FREE /dev/centos_centos7/root\n</code></pre> <pre><code>Size of logical volume centos_centos7/root changed from &lt;17.00 GiB (4351 extents) to 26.99 GiB (6910 extents).\nLogical volume centos_centos7/root successfully resized.\n</code></pre> <p>Last thing to do. Re-sizing the file system we use:</p> <pre><code>xfs_growfs /dev/centos_centos7/root\n</code></pre> <pre><code>meta-data=/dev/mapper/centos_centos7-root isize=512    agcount=4, agsize=1113856 blks\n         =                       sectsz=512   attr=2, projid32bit=1\n         =                       crc=1        finobt=0 spinodes=0\ndata     =                       bsize=4096   blocks=4455424, imaxpct=25\n         =                       sunit=0      swidth=0 blks\nnaming   =version 2              bsize=4096   ascii-ci=0 ftype=1\nlog      =internal               bsize=4096   blocks=2560, version=2\n         =                       sectsz=512   sunit=0 blks, lazy-count=1\nrealtime =none                   extsz=4096   blocks=0, rtextents=0\ndata blocks changed from 4455424 to 7075840\n</code></pre> <p>You are good. That\u2019s all that you need to extend logical volume on CentOS. If you want to confirm that, just check it with the following commands:</p> <pre><code>pvs\n</code></pre> <pre><code>PV         VG             Fmt  Attr PSize   PFree\n/dev/sda2  centos_centos7 lvm2 a--  &lt;19.00g    0\n/dev/sdb1  centos_centos7 lvm2 a--  &lt;10.00g    0\n</code></pre> <pre><code>lvs\n</code></pre> <pre><code>LV   VG             Attr       LSize  Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert\nroot centos_centos7 -wi-ao---- 26.99g\nswap centos_centos7 -wi-ao----  2.00g\n</code></pre> <pre><code>vgs\n</code></pre> <pre><code>VG             #PV #LV #SN Attr   VSize  VFree\ncentos_centos7   2   2   0 wz--n- 28.99g    0\n</code></pre> <p>Thanks!</p>","tags":["Filesystem","Fdisk","LVM","Linux"]},{"location":"posts/extending_disk_space_without_lvm/","title":"Extending disk space on Linux without LVM","text":"<p>This method requires host rebooting and using <code>lsblk</code>, <code>fdisk</code> tools. Removing or creating a partition doesn't remove a data or a filesystem on a disk. It will only update the MBR or GPT information where partition lies and its size.</p>","tags":["Filesystem","Fdisk","Linux"]},{"location":"posts/extending_disk_space_without_lvm/#find-partition-to-extend","title":"Find partition to extend","text":"<p>Run <code>lsblk</code> command to see which mountpoint is assigned to which partition</p> <pre><code>root@debian1101:~# lsblk\nNAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT\nsda      8:0    0   20G  0 disk\n\u251c\u2500sda1   8:1    0  4.1G  0 part /\n\u251c\u2500sda2   8:2    0    1K  0 part\n\u251c\u2500sda5   8:5    0  1.7G  0 part /var\n\u251c\u2500sda6   8:6    0  976M  0 part [SWAP]\n\u251c\u2500sda7   8:7    0  371M  0 part /tmp\n\u2514\u2500sda8   8:8    0 12.9G  0 part /home\nsr0     11:0    1 1024M  0 rom\n</code></pre> <p>Let's say we would like to extend <code>/var</code> partition</p>","tags":["Filesystem","Fdisk","Linux"]},{"location":"posts/extending_disk_space_without_lvm/#add-diskspace-extend-disk-ie-in-vcenter-virtualbox","title":"Add diskspace, extend disk, i.e. in vCenter, VirtualBox","text":"<p>Wherever you have your virtual machine installed, you need to shut it down and increase disk size.</p>","tags":["Filesystem","Fdisk","Linux"]},{"location":"posts/extending_disk_space_without_lvm/#use-fdisk-to-delete-and-re-add-partition","title":"Use <code>fdisk</code> to delete and re-add partition","text":"<p>Run <code>fidsk /dev/sda</code> to start the fdisk menu for this specific partition:</p> <pre><code>root@debian1101:~# fdisk /dev/sda\n\nWelcome to fdisk (util-linux 2.36.1).\nChanges will remain in memory only, until you decide to write them.\nBe careful before using the write command.\n</code></pre>","tags":["Filesystem","Fdisk","Linux"]},{"location":"posts/extending_disk_space_without_lvm/#print-the-partition-table","title":"Print the partition table","text":"<p>With <code>p</code> command you can print partition table:</p> <pre><code>Command (m for help): p\nDisk /dev/sda: 20 GiB, 21474836480 bytes, 41943040 sectors\nDisk model: VBOX HARDDISK\nUnits: sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisklabel type: dos\nDisk identifier: 0xfeb22017\n\nDevice     Boot    Start      End  Sectors  Size Id Type\n/dev/sda1  *        2048  8638463  8636416  4.1G 83 Linux\n/dev/sda2        8640510 41940991 33300482 15.9G  5 Extended\n/dev/sda5        8640512 12167167  3526656  1.7G 83 Linux\n/dev/sda6       12169216 14168063  1998848  976M 82 Linux swap / Solaris\n/dev/sda7       14170112 14929919   759808  371M 83 Linux\n/dev/sda8       14931968 41940991 27009024 12.9G 83 Linux\n</code></pre>","tags":["Filesystem","Fdisk","Linux"]},{"location":"posts/extending_disk_space_without_lvm/#delete-the-partition-we-want-to-extend-with-d-command","title":"Delete the partition we want to extend with <code>d</code> command","text":"<pre><code>Command (m for help): d\nPartition number (1,2,5-8, default 8): 5\n\nPartition 5 has been deleted.\n</code></pre>","tags":["Filesystem","Fdisk","Linux"]},{"location":"posts/extending_disk_space_without_lvm/#create-a-new-partition-with-n-command","title":"Create a new partition with <code>n</code> command","text":"<p>In this stage you need to be careful which blocks are youg going to use. This part might be tricky.</p> <pre><code>Command (m for help): n\nAll space for primary partitions is in use.\nAdding logical partition 8\nFirst sector (8642558-12167167, default 8642560):\nLast sector, +/-sectors or +/-size{K,M,G,T,P} (8642560-12167167, default 12167167):\n\nCreated a new partition 8 of type 'Linux' and of size 1.7 GiB.\n</code></pre>","tags":["Filesystem","Fdisk","Linux"]},{"location":"posts/extending_disk_space_without_lvm/#save-new-partition-table-with-w-command","title":"Save new partition table with <code>w</code> command","text":"<pre><code>Command (m for help): w\nThe partition table has been altered.\n\nThe kernel still uses the old partitions. The new table will be used at the next reboot.\nSyncing disks.\n</code></pre>","tags":["Filesystem","Fdisk","Linux"]},{"location":"posts/extending_disk_space_without_lvm/#resize-filesystem-for-new-partition","title":"Resize filesystem for new partition","text":"<pre><code>root@debian1101:~# resize2fs /dev/sda8\nresize2fs 1.46.2 (28-Feb-2021)\n</code></pre> <p>That's it. Your partition will be bigger now.</p>","tags":["Filesystem","Fdisk","Linux"]},{"location":"posts/find_delete_files/","title":"Delete files older than X days","text":"<p>First let's list files to delete (older than 2 days):</p> <pre><code>find /home/user/some-folders-*/var/ -type f -name \"*.log\" -mtime +2\n</code></pre> <p>After confirming it is safe to delete, delete them:</p> <pre><code>find /home/trades/venus-AvkLinkServer-*/var/ -type f -name \"*.log\" -mtime +2 -exec rm {} \\;\n</code></pre>","tags":["Filesystem","Linux"]},{"location":"posts/gather_ansible_facts/","title":"Gather or update ansible facts","text":"<p>Ansible facts are very useful data related to your remote systems. You can access this data in the <code>ansible_facts</code> variable.</p> <p>This is how to gather or update known facts from the specific server with one command. In this example there is usage of specific python as well. If you want to you can use it without <code>-e</code> parameter.</p> <pre><code>ansible -i /etc/ansible/hosts yourserver.yourdomain.com -m gather_facts -e 'ansible_python_interpreter=/usr/bin/python'\n</code></pre>","tags":["Linux","Ansible"]},{"location":"posts/host_not_allowed_connect_mysql/","title":"Host is not allowed to connect to this MySQL server","text":"<p>If you are not able to connect to your MySQL server you might not have the right permission to get there.</p>","tags":["MySQL","Database","Linux"]},{"location":"posts/host_not_allowed_connect_mysql/#symptoms","title":"Symptoms","text":"<pre><code>Error: The test connection to the database server has failed because of network problems:\n\nHost '203.0.113.2' is not allowed to connect to this MySQL server\n</code></pre>","tags":["MySQL","Database","Linux"]},{"location":"posts/host_not_allowed_connect_mysql/#cause","title":"Cause","text":"<p>root user is not allowed to access the MySQL database server remotely. </p>","tags":["MySQL","Database","Linux"]},{"location":"posts/host_not_allowed_connect_mysql/#solution","title":"Solution","text":"<p>Log in to the MySQL on the remote database server and create a user who is allowed to access database server remotely from 203.0.113.2:</p> <pre><code>mysql&gt; CREATE USER 'root'@'203.0.113.2' IDENTIFIED BY 'root_password';\n</code></pre> <pre><code>mysql&gt; GRANT ALL PRIVILEGES ON *.* TO 'root'@'203.0.113.2' WITH GRANT OPTION;\n</code></pre> <pre><code>mysql&gt; FLUSH PRIVILEGES;\n</code></pre> <p>Or a database user who can access the server from any host:</p> <pre><code>mysql&gt; CREATE USER 'root'@'%' IDENTIFIED BY 'root_password';\n</code></pre> <pre><code>mysql&gt; GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' WITH GRANT OPTION;\n</code></pre> <pre><code>mysql&gt; FLUSH PRIVILEGES;\n</code></pre>","tags":["MySQL","Database","Linux"]},{"location":"posts/increase_swap_space/","title":"Increasing Swap Space Using a Swap File on Linux","text":"<p>Follow these steps to increase the swap space on your Linux system by creating a swap file.</p>","tags":["Filesystem","Linux"]},{"location":"posts/increase_swap_space/#step-1-turn-off-the-existing-swap","title":"Step 1: Turn Off the Existing Swap","text":"<p>First, you need to turn off the existing swap. This can be done with the following command:</p> <pre><code>sudo swapoff -a\n</code></pre>","tags":["Filesystem","Linux"]},{"location":"posts/increase_swap_space/#step-2-create-a-new-swap-file","title":"Step 2: Create a New Swap File","text":"<p>Next, create a new swap file. For example, to create an 8GB swap file, use:</p> <pre><code>sudo dd if=/dev/zero of=/swapfile bs=1G count=8\n</code></pre> <p>Adjust the <code>count</code> value to change the size of the swap file.</p>","tags":["Filesystem","Linux"]},{"location":"posts/increase_swap_space/#step-3-set-the-correct-permissions","title":"Step 3: Set the Correct Permissions","text":"<p>Set the correct permissions for the swap file to ensure that only the root user can read and write to it:</p> <pre><code>sudo chmod 0600 /swapfile\n</code></pre>","tags":["Filesystem","Linux"]},{"location":"posts/increase_swap_space/#step-4-set-up-the-swap-area","title":"Step 4: Set Up the Swap Area","text":"<p>Prepare the file to be used as swap:</p> <pre><code>sudo mkswap /swapfile\n</code></pre>","tags":["Filesystem","Linux"]},{"location":"posts/increase_swap_space/#step-5-enable-the-swap-file","title":"Step 5: Enable the Swap File","text":"<p>Turn the swap on:</p> <pre><code>sudo swapon /swapfile\n</code></pre>","tags":["Filesystem","Linux"]},{"location":"posts/increase_swap_space/#step-6-make-the-swap-file-permanent","title":"Step 6: Make the Swap File Permanent","text":"<p>To ensure the swap file is used after a reboot, add the following line to <code>/etc/fstab</code>:</p> <pre><code>/swapfile none swap defaults 0 0\n</code></pre>","tags":["Filesystem","Linux"]},{"location":"posts/install_percona_mysql8/","title":"How To Install Percona MySQL Server 8 on CentOS 8 / RHEL 8","text":"<p>Just to be sure if your system is up to date:</p> <pre><code>sudo yum -y update\n</code></pre>","tags":["MySQL","Database","Linux"]},{"location":"posts/install_percona_mysql8/#add-percona-yum-repository","title":"Add Percona YUM repository","text":"<pre><code>sudo yum install https://repo.percona.com/yum/percona-release-latest.noarch.rpm\n</code></pre>","tags":["MySQL","Database","Linux"]},{"location":"posts/install_percona_mysql8/#enable-repository-for-mysql-80","title":"Enable repository for MySQL 8.0","text":"<pre><code>sudo percona-release setup ps80\n</code></pre> <p>You will be asked to disable RHEL 8 module for MysQL. Allow that.</p>","tags":["MySQL","Database","Linux"]},{"location":"posts/install_percona_mysql8/#install-percona-server-for-mysql-80","title":"Install Percona Server for MySQL 8.0","text":"<pre><code>sudo yum install percona-server-server percona-toolkit\n</code></pre> <pre><code>sudo percona-release enable-only tools release\n</code></pre> <pre><code>sudo yum install percona-xtrabackup-80\n</code></pre>","tags":["MySQL","Database","Linux"]},{"location":"posts/install_percona_mysql8/#start-and-secure-percona-mysql-server","title":"Start and secure Percona MySQL Server","text":"<pre><code>sudo systemctl enable mysqld\n</code></pre> <pre><code>sudo systemctl start mysqld\n</code></pre>","tags":["MySQL","Database","Linux"]},{"location":"posts/install_percona_mysql8/#find-generated-root-temporary-password","title":"Find generated root temporary password","text":"<pre><code>sudo grep \"temporary password\" /var/log/mysqld.log\n</code></pre> <p>After that you can start MySQL installation:</p> <pre><code>mysql_secure_installation\n</code></pre>","tags":["MySQL","Database","Linux"]},{"location":"posts/iptables_basics/","title":"Useful iptables commands","text":"","tags":["Iptables","Network","Linux"]},{"location":"posts/iptables_basics/#show-iptables-with-line-numbers","title":"Show iptables with line numbers","text":"<pre><code>iptables -nL --line-numbers\n</code></pre> <p><code>-n</code> \u2013 Numeric output. IP addresses and port numbers will be printed in numeric format. <code>-L</code> \u2013 List all rules in the selected chain. If no chain is selected, all chains are listed.</p>","tags":["Iptables","Network","Linux"]},{"location":"posts/iptables_basics/#insert-add-rule-in-the-specific-place-in-iptables-as-it-works-descending","title":"Insert (add) rule in the specific place in iptables as it works descending","text":"<pre><code>sudo iptables -I INPUT 9 -i eth0 -d 192.168.1.254 -j ACCEPT -m comment --comment \"my new comment\"\n</code></pre> <p>Number \u201c9\u201d in the example above stands for this rule will be inserted on the ninth place in iptables.</p>","tags":["Iptables","Network","Linux"]},{"location":"posts/linux_firmware_update/","title":"Update Linux firmware from terminal","text":"<p>We will use <code>fwupd</code> which should be installed. If not, install it using package manager.</p> <p>Open terminal and update your system:</p> <pre><code>sudo apt update &amp;&amp; sudo apt upgrade -y\n</code></pre> <p>Next, just use the following commands. It will start the daemon, refresh the list of available firmware and install updates.</p> <pre><code>sudo systemctl start fwupd\n</code></pre> <pre><code>sudo fwupdmgr refresh\n</code></pre> <pre><code>sudo fwupdmgr update\n</code></pre> <p>That's it. After that your firmware will be up to date.</p>","tags":["Linux","Ubuntu","Debian"]},{"location":"posts/mysql8_caching_sha2_pass/","title":"MySQL 8 \u2013 Authentication plugin \u2018caching_sha2_password\u2019 cannot be loaded","text":"<p>This is an issue on MySQL 8 that changed the default authentication method and mysql client doesn\u2019t understand it. If you want to use MySQL 8 you should set it up using the native password authentication method. To do that you need to use the following command in your MySQL instance:</p> <pre><code>ALTER USER 'username'@'ip_address' IDENTIFIED WITH mysql_native_password BY 'password';\n</code></pre>","tags":["MySQL","Database","Linux"]},{"location":"posts/mysql_password_policy/","title":"How to change MySQL Password Policy Level","text":"<p>The latest MySQL servers come with a validate password plugin. This plugin configures a password policy to make server MySQL more secure.</p> <p>While changing the password, I got the error: <code>ERROR 1819 (HY000): Your password does not satisfy the current policy requirements.</code></p> <p>Follow the below tutorial to change password policy level for MySQL.</p> <p>To change the default password policy level, we can change the settings at runtime using the command line or in the config file (<code>my.cnf</code> or <code>mysqld.cnf</code>) permanently.</p> <p>Login to MySQL command prompt and execute the below query to view current settings of <code>validate_password</code>.</p> <pre><code>mysql&gt; SHOW VARIABLES LIKE 'validate_password%';\n</code></pre> <pre><code>+--------------------------------------+--------+\n| Variable_name                        | Value  |\n+--------------------------------------+--------+\n| validate_password.check_user_name    | OFF    |\n| validate_password.dictionary_file    |        |\n| validate_password.length             | 8      |\n| validate_password.mixed_case_count   | 1      |\n| validate_password.number_count       | 1      |\n| validate_password.policy             | MEDIUM |\n| validate_password.special_char_count | 1      |\n+--------------------------------------+--------+\n7 rows in set (0.06 sec)\n</code></pre> <p>The default level is <code>MEDIUM</code>, we can change it to <code>LOW</code> by using the below query. The <code>LOW</code> level required only the password\u2019s length to min 8 characters.</p> <pre><code>mysql&gt; SET GLOBAL validate_password.policy=LOW;\n</code></pre> <pre><code>Query OK, 0 rows affected (0.02 sec)\n</code></pre> <p>To make this setting permanent edit MySQL configuration (<code>my.cnf</code>) file and add below settings.</p> <pre><code>[mysqld]\nvalidate_password.policy=LOW\n</code></pre>","tags":["MySQL","Database","Linux"]},{"location":"posts/mysql_table_size/","title":"How to get the size of a table in MySQL","text":"<p>As can see in the official documentation, the <code>INFORMATION_SCHEMA</code>.<code>TABLES</code> table contains around 20 columns, but for the purpose of determining the amount of disk space used by tables, we\u2019ll focus on two columns in particular: <code>DATA_LENGTH</code> and <code>INDEX_LENGTH</code>.</p> <ul> <li><code>DATA_LENGTH</code> is the length (or size) of all data in the table (in bytes).</li> <li><code>INDEX_LENGTH</code> is the length (or size) of the index file for the table (also in bytes).</li> </ul> <p>Armed with this information, we can execute a query that will list all tables in a specific database along with the disk space (size) of each. We can even get a bit fancier and convert the normal size values from bytes into something more useful and understandable to most people like megabytes.</p> <pre><code>SELECT\n  TABLE_NAME AS `Table`,\n  ROUND((DATA_LENGTH + INDEX_LENGTH) / 1024 / 1024) AS `Size (MB)`\nFROM\n  information_schema.TABLES\nWHERE\n  TABLE_SCHEMA = \"bookstore\"\nORDER BY\n  (DATA_LENGTH + INDEX_LENGTH)\nDESC;\n</code></pre> <p>Version to copy:</p> <pre><code>SELECT TABLE_NAME AS `Table`, ROUND((DATA_LENGTH + INDEX_LENGTH) /\n 1024 / 1024) AS `Size (MB)` FROM information_schema.TABLES WHERE \nTABLE_SCHEMA = \"bookstore\" ORDER BY (DATA_LENGTH + INDEX_LENGTH) DESC;\n</code></pre> <p>In this example using the bookstore database, we\u2019re combining the <code>DATA_LENGTH</code> and <code>INDEX_LENGTH</code> as bytes, then dividing it by 1024 twice to convert into kilobytes and then megabytes. Our result set will look something like this:</p> <pre><code>+----------------------------------+-----------+\n| Table                            | Size (MB) |\n+----------------------------------+-----------+\n| book                             |       267 |\n| author                           |        39 |\n| post                             |        27 |\n| cache                            |        24 |\n...\n</code></pre> <p>If you don\u2019t care about all tables in the database and only want the size of a particular table, you can simply add <code>AND TABLE_NAME = \u201cyour_table_name\u201d</code> to the <code>WHERE</code> clause. Here we only want information about the book table:</p> <pre><code>SELECT\n  TABLE_NAME AS `Table`,\n  ROUND((DATA_LENGTH + INDEX_LENGTH) / 1024 / 1024) AS `Size (MB)`\nFROM\n  information_schema.TABLES\nWHERE\n    TABLE_SCHEMA = \"bookstore\"\n  AND\n    TABLE_NAME = \"book\"\nORDER BY\n  (DATA_LENGTH + INDEX_LENGTH)\nDESC;\n</code></pre> <p>Version to copy:</p> <pre><code>SELECT TABLE_NAME AS `Table`, ROUND((DATA_LENGTH + INDEX_LENGTH) /\n 1024 / 1024) AS `Size (MB)` FROM information_schema.TABLES WHERE \nTABLE_SCHEMA = \"bookstore\" AND TABLE_NAME = \"book\" ORDER BY (DATA_LENGTH\n + INDEX_LENGTH) DESC;\n</code></pre> <p>The results, as expected, are now:</p> <pre><code>+-------+-----------+\n| Table | Size (MB) |\n+-------+-----------+\n| book  |       267 |\n+-------+-----------+\n1 row in set (0.00 sec)\n</code></pre>","tags":["MySQL","Database","Linux"]},{"location":"posts/partman_lvm_preseed/","title":"Create partman LVM partitions on Debian with preseed","text":"<p>Example, how to write a template for Debian to create LVM partitions with partman. It is a bit tricky, as first we have to create boot partition, then virtual group, and further we are able to create partitions by assigning them to volume group.</p> <pre><code>d-i partman-auto/expert_recipe string                 \\\n      root ::                                         \\\n            300 512 2048 ext4                         \\\n                method{ format } format{ }            \\\n                $primary{ } $bootable{ }              \\\n                use_filesystem{ } filesystem{ ext4 }  \\\n                mountpoint{ /boot }                   \\\n            .                                         \\\n            2048 20480 -1 xfs                         \\\n                method{ lvm }                         \\\n                device{ /dev/sda }                    \\\n                vg_name{ vg00 }                       \\\n            .                                         \\\n            512 1024 2048 linux-swap                  \\\n                method{ swap } format{ }              \\\n                $lvmok{ }                             \\\n                in_vg{ vg00 }                         \\\n                lv_name{ swap }                       \\\n            .                                         \\\n            10240 20480 20480 xfs                     \\\n                method{ format } format{ }            \\\n                $lvmok{ }                             \\\n                lv_name{ root }                       \\\n                in_vg{ vg00 }                         \\\n                use_filesystem{ } filesystem{ xfs }   \\\n                mountpoint{ / }                       \\\n            .                                         \\\n            10240 20480 20480 xfs                     \\\n                method{ format } format{ }            \\\n                $lvmok{ }                             \\\n                lv_name{ var }                        \\\n                in_vg{ vg00 }                         \\\n                use_filesystem{ } filesystem{ xfs }   \\\n                mountpoint{ /var }                    \\\n            .                                         \\\n            10240 20480 20480 xfs                     \\\n                method{ format } format{ }            \\\n                $lvmok{ }                             \\\n                lv_name{ opt }                        \\\n                in_vg{ vg00 }                         \\\n                use_filesystem{ } filesystem{ xfs }   \\\n                mountpoint{ /opt }                    \\\n            .                                         \\\n            10240 20480 -1 xfs                        \\\n                method{ format } format{ }            \\\n                $lvmok{ }                             \\\n                lv_name{ home }                       \\\n                in_vg{ vg00 }                         \\\n                use_filesystem{ } filesystem{ xfs }   \\\n                mountpoint{ /home }                   \\\n            .                                         \\\n</code></pre>","tags":["LVM","Preseed","Partman","Debian"]},{"location":"posts/repair_corrupted_usb_drive/","title":"How to repair corrupted USB drive in Linux","text":"<p>If you have a USB drive you can\u2019t read or write or it\u2019s shrunk you should follow steps below.</p> <p>Locate the name of your USB drive with <code>lsblk</code> command.</p>","tags":["Filesystem","Fdisk","Linux"]},{"location":"posts/repair_corrupted_usb_drive/#remove-old-partitions","title":"Remove old partitions","text":"<p>Go to <code>fdisk</code> using the following command and delete all partitions.</p> <pre><code>fdisk /dev/sdc\n</code></pre> <p>Type <code>d</code> and press <code>enter</code> and proceed with <code>d</code> and <code>enter</code> to delete another portion, if necessary.</p>","tags":["Filesystem","Fdisk","Linux"]},{"location":"posts/repair_corrupted_usb_drive/#new-partitions","title":"New partitions","text":"<p>Next, we need to create a new partition. Type <code>n</code> for new partition. Type <code>p</code> to make this primary. Type <code>1</code> to make this the first partition. <code>enter</code> to accept default first sector and last sector. Type <code>w</code> to write the new partition information</p> <p>Next, you need to unmount drive with:</p> <pre><code>umount /dev/sdc1\n</code></pre> <p>New filesystem:</p> <p>Create filesystem with the following commands:</p> <pre><code>mkfs.ext4 -f /dev/sdc1\n</code></pre> <p>or</p> <pre><code>mkfs.ntfs -f /dev/sdc1\n</code></pre>","tags":["Filesystem","Fdisk","Linux"]},{"location":"posts/repair_corrupted_usb_drive_win/","title":"How to repair corrupted USB drive in Windows","text":"<p>Restore a USB drive using Diskpart \u2013 Windows</p> <p>Open a command Prompt as administrator (<code>cmd.exe</code>) and use the following commands.</p> <ol> <li><code>Diskpart</code> then press <code>Enter</code> </li> <li><code>List Disk</code> then press <code>Enter</code> </li> <li><code>Select Disk X</code> (where X is the disk number of your USB drive) then press <code>Enter</code> </li> <li><code>Clean</code> then press <code>Enter</code> </li> <li><code>Create Partition Primary</code> then press <code>Enter</code></li> <li><code>Format fs=Fat32 Quick</code> then press <code>Enter</code> (You can also use <code>NTFS</code> or <code>exFAT</code>)</li> <li><code>Active</code> then press <code>Enter</code></li> </ol>","tags":["Filesystem","Diskpart","Windows"]},{"location":"posts/scp_transfer/","title":"How to use SCP command to transfer files","text":"<p>SCP (secure copy) is a command-line utility that allows you to securely copy files and directories between two locations.</p> <p>SCP command syntax</p> <pre><code>scp [-346BCpqrTv] [-c cipher] [-F ssh_config] [-i identity_file] [-J destination] [-l limit] [-o ssh_option] [-P port] [-S program] source ... target\n</code></pre> <p>Every option is explained in manual that you can reach using command:</p> <pre><code>man scp\n</code></pre> <p>Copy Files and Directories between two systems with SCP</p> <pre><code>scp file.txt username@ip_address:/remote/directory\n</code></pre> <p>If SSH on the remote host is listening on a port other than default 22 then you can specify port using the <code>-P</code> parameter:</p> <pre><code>scp -P 2232 file.txt username@ip_address:/remote/directory\n</code></pre> <p>To copy directory you need to use <code>-r</code> parameter, that means recursive:</p> <pre><code>scp -r /local/directory username@ip_address:/remote/directory\n</code></pre>","tags":["Filesystem","SCP","Linux"]},{"location":"posts/screen_use/","title":"How to use basic screen commands on Linux","text":"<p>List screen sessions:</p> <pre><code>screen -ls\n</code></pre> <p>Name and open new screen session:</p> <pre><code>screen -S session_name\n</code></pre> <p>Reattach screen session:</p> <pre><code>screen -r sessions_name\n</code></pre>","tags":["Linux","Tools"]},{"location":"posts/screen_use/#screen-shortcuts","title":"Screen shortcuts","text":"","tags":["Linux","Tools"]},{"location":"posts/screen_use/#split-screen","title":"Split screen","text":"","tags":["Linux","Tools"]},{"location":"posts/screen_use/#new-split","title":"New split","text":"<ul> <li><code>Ctrl + a</code> then <code>|</code> : vertical split. By default, this command will split your current window into two different areas that you can interact with.</li> <li><code>Ctrl + a</code> then <code>S</code> : horizontal split.</li> </ul>","tags":["Linux","Tools"]},{"location":"posts/screen_use/#close-split","title":"Close split","text":"<ul> <li><code>Ctrl + a</code> then <code>X</code> : closes active split.</li> <li><code>Ctrl + a</code> then <code>Q</code> : closes all splits.</li> </ul>","tags":["Linux","Tools"]},{"location":"posts/screen_use/#move-around-splits","title":"Move around splits","text":"<ul> <li><code>Ctrl + a</code> then <code>n</code> : used to navigate between your different window sessions from the one with the lowest index until the one with the greater index.</li> <li><code>Ctrl + a</code> then <code>Tab</code> : used in order to move your input cursor to one of your different areas within screen.</li> </ul>","tags":["Linux","Tools"]},{"location":"posts/screen_use/#new-command","title":"New command","text":"<ul> <li><code>Ctrl + a</code> then <code>c</code> : screen command. One of the most used commands by far, those bindings are used in order to create a new window within your screen instance.</li> </ul>","tags":["Linux","Tools"]},{"location":"posts/screen_use/#other","title":"Other","text":"<ul> <li><code>Ctrl + a</code> then <code>d</code> : detach mode. You can use this option in order to detach (meaning going back to your original shell) and let screen run in the background. This is particularly handy when you are running long tasks on your host.</li> <li><code>Ctrl + a</code> then <code>x</code> : lockscreen. This is used in order to protect your screen session to be used by another user. As a consequence, a password is set to your session.</li> </ul>","tags":["Linux","Tools"]},{"location":"posts/snap_refresh/","title":"Update Snap package and snap-store","text":"<p>The command has been tested on Ubuntu 22.04  </p> <p><code>sudo killall snap-store &amp;&amp; snap refresh</code></p> <p>Running this command will kill current snap-store process and it will upgrade all upgradable snap packages.</p>","tags":["Snap","Repository","Linux","Ubuntu","Debian"]},{"location":"posts/speed_test_between_hosts/","title":"How to test link speed between two hosts","text":"<p>In this manual we are going to use <code>iperf</code></p>","tags":["Network","Linux"]},{"location":"posts/speed_test_between_hosts/#installation","title":"Installation","text":"<p>On both hosts run:</p> <pre><code>sudo apt-get install iperf\n</code></pre>","tags":["Network","Linux"]},{"location":"posts/speed_test_between_hosts/#start-iperf-as-a-server-on-one-of-the-machines","title":"Start <code>iperf</code> as a server on one of the machines","text":"<pre><code>iperf -s\n</code></pre>","tags":["Network","Linux"]},{"location":"posts/speed_test_between_hosts/#run-iperf-as-a-client","title":"Run <code>iperf</code> as a client","text":"<pre><code>iperf -c IPERF_SERVER_ADDRESS\n</code></pre> <p>After this command you will see something like:</p> <pre><code>user@IPERF_CLIENT:~$ iperf -c IPERF_SERVER_ADDRESS\n------------------------------------------------------------\nClient connecting to IPERF_SERVER_ADDRESS, TCP port 5001\nTCP window size: 16.0 KByte (default)\n------------------------------------------------------------\n[  3] local 192.168.0.4 port 37248 connected with 192.168.0.5 port 5001\n[ ID] Interval       Transfer     Bandwidth\n[  3]  0.0-10.0 sec  1.04 GBytes    893 Mbits/sec\n</code></pre> <p>As you can see it is running on the 5001 port by default. If you want to change the port, use <code>-p</code> parameter.</p>","tags":["Network","Linux"]},{"location":"posts/ssh_permissions/","title":"Required permissions for SSH keys, files and folders","text":"Item Sample Numeric Bitwise Command SSH folder <code>~/.ssh</code> <code>700</code> <code>drwx------</code> <code>chmod 0700 ~/.ssh</code> Public key <code>~/.ssh/id_rsa.pub</code> <code>644</code> <code>-rw-r--r--</code> <code>chmod 0644 ~/.ssh/id_rsa.pub</code> Private key <code>~/.ssh/id_rsa</code> <code>600</code> <code>-rw-------</code> <code>chmod 0600 ~/.ssh/id_rsa</code> Home folder <code>~</code> <code>755</code> at most <code>drwxr-xr-x</code> at most <code>chmod 0755 ~</code>","tags":["Filesystem","Linux","SSH"]},{"location":"posts/static_ip_centos8/","title":"Configuration of a static IP address on CentOS 8","text":"<p>There are a few ways to configure static IP on CentOS systems but I\u2019ll show you how to do it just through editing config files</p> <p>We need to identify our interface that we would like to edit. We can do this using the following command:</p> <pre><code>ip a\n</code></pre> <pre><code>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host\n       valid_lft forever preferred_lft forever\n2: enp0s3: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000\n    link/ether 08:00:27:d7:61:91 brd ff:ff:ff:ff:ff:ff\n    inet 192.168.178.89/24 brd 192.168.178.255 scope global dynamic noprefixroute enp0s3\n       valid_lft 85177sec preferred_lft 85177sec\n    inet6 2002:c2bf:e06a:0:9204:bf9d:ab95:aa91/128 scope global dynamic noprefixroute\n       valid_lft 5978sec preferred_lft 2378sec\n    inet6 2002:c2bf:e06a:0:771:5fa8:a2c7:4322/64 scope global dynamic noprefixroute\n       valid_lft 6956sec preferred_lft 3356sec\n    inet6 fe80::9204:bf9d:ab95:aa91/64 scope link noprefixroute\n       valid_lft forever preferred_lft forever\n3: virbr0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN group default qlen 1000\n    link/ether 52:54:00:13:f3:a7 brd ff:ff:ff:ff:ff:ff\n    inet 192.168.122.1/24 brd 192.168.122.255 scope global virbr0\n       valid_lft forever preferred_lft forever\n4: virbr0-nic: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc fq_codel master virbr0 state DOWN group default qlen 1000\n    link/ether 52:54:00:13:f3:a7 brd ff:ff:ff:ff:ff:ff\n</code></pre> <p>Next we need to edit or create config file for this interface in this location:</p> <pre><code>vim /etc/sysconfig/network-scripts/ifcfg-ens10\n</code></pre> <p>and add following arguments:</p> <pre><code>TYPE=Ethernet\nPROXY_METHOD=none\nBROWSER_ONLY=no\nBOOTPROTO=static\nDEFROUTE=yes\nIPV4_FAILURE_FATAL=no\nIPV6INIT=yes\nIPV6_AUTOCONF=yes\nIPV6_DEFROUTE=yes\nIPV6_FAILURE_FATAL=no\nIPV6_ADDR_GEN_MODE=stable-privacy\nNAME=enp0s3\nUUID=6f23bb02-a7bf-412d-beca-4b425d866596\nDEVICE=enp0s3\nONBOOT=yes\nIPADDR=192.168.178.89\nPREFIX=24\nGATEWAY=192.168.178.1\n</code></pre> <p>Parameters like <code>IPADDR</code>, <code>PREFIX</code>, <code>GATEWAY</code>, <code>DNS1</code>, <code>DNS2</code> etc. are almost necessary.  </p> <p>We need to remember to change <code>BOOTPROTO</code> to <code>none</code> or <code>static</code>.  </p> <p>Thanks!</p>","tags":["Network","Linux"]},{"location":"posts/two_gateways_centos/","title":"Two default gateways on CentOS","text":"<p>You have two or more network cards (interfaces) in one Linux system and each of these interfaces has its own default gateway. By default, you can only have one default gateway on a system.</p> <p>We assume that we have two interfaces: <code>eth0</code> <code>eth1</code></p> <p>Two networks that should be used are: <code>192.168.1.0/24</code> <code>10.10.0.0/24</code></p> <p>whereby the first IP address in each respective network should be the gateway. Config files for these interfaces are in: <code>/etc/sysconfing/network-scripts/ifcfg-eth0</code> and <code>ifcfg-eth1</code> and it looks like this: <code>cat /etc/sysconfig/network-scripts/ifcfg-eth0</code></p> <pre><code>TYPE=Ethernet\nPROXY_METHOD=none\nBROWSER_ONLY=no\nBOOTPROTO=none\nDEFROUTE=yes\nIPV4_FAILURE_FATAL=no\nIPV6INIT=no\nIPV6_AUTOCONF=\"yes\"\nIPV6_DEFROUTE=\"yes\"\nIPV6_FAILURE_FATAL=\"no\"\nIPV6_ADDR_GEN_MODE=\"stable-privacy\"\nNAME=eth0\nUUID=7f164bfd-1ae4-4062-aadd-e2ea8bc0121e\nDEVICE=eth0\nONBOOT=yes\nIPADDR=192.168.1.5\nPREFIX=24\nGATEWAY=192.168.1.1\nDNS1=8.8.8.8\nDNS2=1.1.1.1\n</code></pre> <p><code>cat /etc/sysconfig/network-scripts/ifcfg-eth1</code></p> <pre><code>TYPE=Ethernet\nPROXY_METHOD=none\nBROWSER_ONLY=no\nBOOTPROTO=none\nIPADDR=10.10.0.124\nPREFIX=24\nDNS1=8.8.8.8\nDNS2=1.1.1.1\nDEFROUTE=yes\nIPV4_FAILURE_FATAL=no\nIPV6INIT=no\nNAME=eth1\nUUID=9320b706-e68e-3610-9fec-9988316bd478\nDEVICE=eth1\nONBOOT=yes\nGATEWAY=10.10.0.1\nNETMASK=255.255.255.0\nNM_CONTROLLED=yes\n</code></pre> <p>To use a second interface and address we need to add another routing table. To do this go to file: <code>vim /etc/iproute2/rt_tables</code></p> <p>and add at the end <code>1 rt2</code>:</p> <pre><code>#\n# reserved values\n#\n255     local\n254     main\n253     default\n0       unspec\n#\n# local\n#\n#1      inr.ruhep\n1 rt2\n</code></pre> <p>Now we need to add routing rules and routes: <code>ip route add default via 10.10.0.1 dev eth1 table rt2</code> <code>ip rule add from 10.10.0.0/24 table rt2</code></p> <p>You can check these changes with commands: <code>ip route show table rt2</code> <code>ip rule show</code></p> <p>If you would like to keep these changes after a system reboot it will be necessary to create systemd service. So, the first step is to create a script: <code>vim /usr/local/bin/default_routes.sh</code></p> <pre><code># !/bin/bash\nip route add default via 10.70.70.2 dev eth1 table int\n</code></pre> <p>Don\u2019t forget to change permissions to allow execute this file: <code>chmod +x /usr/local/bin/default_routes.sh</code></p> <p>Now, we can create a systemd service. Create a file and add the necessary parameters: <code>vim /etc/systemd/system/default_route.service</code></p> <pre><code>[Unit]\nDescription=It adds default route for eth1\nWants=network-online.target\nAfter=network-online.target\n\n[Service]\nType=oneshot\nExecStart=/usr/local/bin/default_routes.sh\nTimeoutStartSec=0\n\n[Install]\nWantedBy=default.target\n</code></pre> <p>That\u2019s all. Thank you.</p>","tags":["Linux","CentOS","Network"]},{"location":"posts/var_to_new_partition/","title":"How to move /var to new partition in CentOS 7","text":"<p>If you need to move you /var to new partition in CentOS 7 you will need commands like below.</p> <p>Create new directory:  </p> <pre><code>mkdir /mnt/var_new\n</code></pre> <p>Mount lvm:  </p> <pre><code>mount /dev/vg00/lvo10 /mnt/var_new\n</code></pre> <p>Copy and sync content:  </p> <pre><code>rsync -avH /var/ /mnt/var_new\n</code></pre> <p>Check content in two directories:  </p> <pre><code>diff -r /var /mnt/var_new\n</code></pre> <p>Rename <code>/var</code>:  </p> <pre><code>mv /var /var_old\n</code></pre> <p>Create new <code>/var</code>:  </p> <pre><code>mkdir /var\n</code></pre> <p>Add fstab entry:  </p> <pre><code>/dev/vg00/lvo10 /var xfs defaults 0 0\n</code></pre> <p>Unmount <code>/mnt/var_new</code>:  </p> <pre><code>umount /mnt/var_new\n</code></pre> <p>Mount <code>/var</code>:  </p> <pre><code>mount /var\n</code></pre>","tags":["Filesystem","Linux"]}]}